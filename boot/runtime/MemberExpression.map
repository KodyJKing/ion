{"version":3,"sources":["MemberExpression.ion"],"names":["ion","DynamicExpression","MemberExpression","properties","activate",{"type":"Identifier","name":"activate","loc":{"start":{"line":7,"column":8,"fixed":true},"end":{"line":7,"column":16,"fixed":true}}},"objectExpression","context","createRuntime","object","propertyExpression","computed","property","name","watch","propertyWatcher","propertyValue","updateValue","objectWatcher","objectValue","objectObserver","observe","changes","deactivate","unwatch","value","get","setValue","setMemberValue","set"],"mappings":"aAAA;AAAA,IACIA,GAAA,G,OAAM,CAAO,KAAP,CADV,EAEIC,iBAAA,G,OAAoB,CAAO,qBAAP,CAFxB;IAIaC,gB;;QACTC,UAAA,EAAW;AAAA,YACPC,QAAA,EAAUC,YAClB;AAAA,gB,iCADQD,Q,uBACI,CAAZ;AAAA,gBACY,KAACE,gBAAD,QAACA,gB,WAAD,KAACA,gB,GAAoB,KAACC,OAAD,CAASC,aAAT,CAAuB,KAACC,MAAxB,CAArB,CADZ;AAAA,gBAEY,KAACC,kBAAD,QAACA,kB,WAAD,KAACA,kB,GAAsB,KAACH,OAAD,CAASC,aAAT,CAAuB,KAACG,QAAD,GAAY,KAACC,QAAb,GAAwB,KAACA,QAAD,CAAUC,IAAzD,CAAvB,CAFZ;AAAA,gBAIY,KAACH,kBAAD,CAAoBI,KAApB,CACI,KAACC,eAAD,QAACA,e,WAAD,KAACA,e,YAAmB,UAACC,aAAD,EACpC;AAAA,oBAAoB,KAACA,aAAD,GAAiBA,aAAjB,CAApB;AAAA,oBACoB,KAACC,WAAD,GADpB;AAAA,iB,OAFY,EAJZ;AAAA,gBAUY,KAACX,gBAAD,CAAkBQ,KAAlB,CACI,KAACI,aAAD,QAACA,a,WAAD,KAACA,a,YAAiB,UAACC,WAAD,EAClC;AAAA,oBAAoB,KAACA,WAAD,GAAeA,WAAf,CAApB;AAAA,oBACoB,KAACF,WAAD,GADpB;AAAA,oBAGoB,KAACG,c,WAAD,KAACA,cAAD,E,SAAA,CAHpB;AAAA,oBAIoB,IAAGD,W,QAAH,EACpB;AAAA,wBAAwB,KAACC,cAAD,GAAkBpB,GAAA,CAAIqB,OAAJ,CACdF,WADc,E,SAEd,UAACG,OAAD,EAC5B;AAAA,4BAAgC,KAACL,WAAD,GAAhC;AAAA,yB,OAH0C,EAId,KAACD,aAJa,CAAlB,CAAxB;AAAA,qBALA;AAAA,iB,OAFY,EAVZ;AAAA,aAFe;AAAA,YA0BPO,UAAA,EAAYlB,YACpB;AAAA,gB,iCADQkB,U,uBACI,CAAZ;AAAA,gBACY,KAACjB,gBAAD,CAAkBkB,OAAlB,CAA0B,KAACN,aAA3B,EADZ;AAAA,gBAEY,KAACR,kBAAD,CAAoBc,OAApB,CAA4B,KAACT,eAA7B,EAFZ;AAAA,aA3Be;AAAA,YA8BPE,WAAA,EAAaZ,YACrB;AAAA,gBAAY,IAAIoB,KAAA,GAAQ,MAAZ,CAAZ;AAAA,gBACY,IAAG,KAACN,W,QAAD,IAAkB,KAACH,a,QAAtB,EACZ;AAAA,oBAAgBS,KAAA,GAAQzB,GAAA,CAAI0B,GAAJ,CAAQ,KAACP,WAAT,EAAsB,KAACH,aAAvB,CAAR,CAAhB;AAAA,iBAFA;AAAA,gBAGY,KAACW,QAAD,CAAUF,KAAV,EAHZ;AAAA,aA/Be;AAAA,YAoCPG,cAAA,EAAgBvB,UAACoB,KAADpB,EAExB;AAAA,gBAAY,IAAG,KAACc,W,QAAD,IAAkB,KAACH,a,QAAtB,EACZ;AAAA,oBAAgBhB,GAAA,CAAI6B,GAAJ,CAAQ,KAACV,WAAT,EAAsB,KAACH,aAAvB,EAAsCS,KAAtC,EAAhB;AAAA,iBADA;AAAA,aAtCe;AAAA,S;OADuBxB,iB,EAJtC;2BAIaC,gB","sourcesContent":["const\r\n    ion = import '../'\r\n    DynamicExpression = import './DynamicExpression'\r\n\r\nexport class MemberExpression extends DynamicExpression\r\n    properties:\r\n        activate: ->\r\n            super\r\n            @objectExpression ?= @context.createRuntime(@object)\r\n            @propertyExpression ?= @context.createRuntime(@computed ? @property : @property.name)\r\n\r\n            @propertyExpression.watch(\r\n                @propertyWatcher ?= (propertyValue) =>\r\n                    @propertyValue = propertyValue\r\n                    @updateValue()\r\n            )\r\n\r\n            @objectExpression.watch(\r\n                @objectWatcher ?= (objectValue) =>\r\n                    @objectValue = objectValue\r\n                    @updateValue()\r\n                    # also observe the objectValue for changes\r\n                    @objectObserver?()\r\n                    if objectValue?\r\n                        @objectObserver = ion.observe(\r\n                            objectValue\r\n                            (changes) =>\r\n                                @updateValue()\r\n                            @propertyValue\r\n                        )\r\n            )\r\n        deactivate: ->\r\n            super\r\n            @objectExpression.unwatch(@objectWatcher)\r\n            @propertyExpression.unwatch(@propertyWatcher)\r\n        updateValue: ->\r\n            let value = undefined\r\n            if @objectValue? and @propertyValue?\r\n                value = ion.get(@objectValue, @propertyValue)\r\n            @setValue(value)\r\n        # sets the underlying property value.  This may be used for two way binding.\r\n        setMemberValue: (value) ->\r\n            # console.log('setMemberValue BITCHES!', @objectValue, @propertyValue, value)\r\n            if @objectValue? and @propertyValue?\r\n                ion.set(@objectValue, @propertyValue, value)\r\n"]}