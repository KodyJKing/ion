{"version":3,"sources":["ObjectExpression.ion"],"names":["ion","DynamicExpression","ObjectExpression","properties","setLeftValue",{"type":"Identifier","name":"setLeftValue","loc":{"start":{"line":8,"column":8,"fixed":true},"end":{"line":8,"column":20,"fixed":true}}},"value","activate","typeExpression","context","createRuntime","objectType","watch","typeWatcher","type","is","statements","deactivate","newContext","body","setValue","unwatch"],"mappings":"aAAA;AAAA,IACIA,GAAA,G,OAAM,CAAO,KAAP,CADV,EAEIC,iBAAA,G,OAAoB,CAAO,qBAAP,CAFxB;IAIaC,gB;;QACTC,UAAA,EAAW;AAAA,YAEPC,YAAA,EAAcC,UAACC,KAADD,EACtB;AAAA,gBAAY,KAACC,KAAD,GAASA,KAAT,CAAZ;AAAA,aAHe;AAAA,YAIPC,QAAA,EAAUF,YAClB;AAAA,gB,iCADQE,Q,uBACI,CAAZ;AAAA,gBACY,KAACC,cAAD,QAACA,c,WAAD,KAACA,c,GAAkB,KAACC,OAAD,CAASC,aAAT,CAAuB,KAACC,U,WAAD,KAACA,U,GAAa,IAArC,CAAnB,CADZ;AAAA,gBAEa,KAACH,cAAD,CAAgBI,KAAjB,CACI,KAACC,WAAD,QAACA,W,WAAD,KAACA,W,YAAe,UAACC,IAAD,EAChC;AAAA,oBAAoB,IAAIR,KAAJ,CAApB;AAAA,oBACoB,IAAG,CAAIN,GAAA,CAAIe,EAAJ,CAAO,KAACT,KAAR,EAAeQ,IAAf,CAAP,EACpB;AAAA,wBAAwB,KAACE,U,WAAD,KAACA,UAAD,CAAaC,UAAb,E,SAAA,CAAxB;AAAA,wBACwB,KAACD,UAAD,GAAc,IAAd,CADxB;AAAA,wBAEwBV,KAAA,GAAQQ,I,WAAAA,I,GAAO,EAAf,CAFxB;AAAA,qBADoB,MAMpB;AAAA,wBAAwBR,KAAA,GAAQ,KAACA,KAAT,CAAxB;AAAA,qBAPA;AAAA,oBASoB,IAAGA,K,QAAA,IAAW,C,CAAI,KAACU,U,SAAnB,EACpB;AAAA,wBAAwB,IAAIE,UAAA,GAAa,KAACT,OAAD,CAASS,UAAT,CAAoBZ,KAApB,CAAjB,CAAxB;AAAA,wBACwB,KAACU,UAAD,GAAcE,UAAA,CAAWR,aAAX,CAAyB;AAAA,4BAACI,IAAA,EAAK,gBAAN;AAAA,4BAAwBK,IAAA,EAAK,KAAChB,UAA9B;AAAA,yBAAzB,CAAd,CADxB;AAAA,wBAEwB,KAACa,UAAD,CAAYT,QAAZ,GAFxB;AAAA,qBAVA;AAAA,oBAcoB,KAACa,QAAD,CAAUd,KAAV,EAdpB;AAAA,iB,OAFY,EAFZ;AAAA,aALe;AAAA,YAwBPW,UAAA,EAAYZ,YACpB;AAAA,gB,iCADQY,U,uBACI,CAAZ;AAAA,gBACY,KAACT,cAAD,CAAgBa,OAAhB,CAAwB,KAACR,WAAzB,EADZ;AAAA,aAzBe;AAAA,S;OADuBZ,iB,EAJtC;2BAIaC,gB","sourcesContent":["const\r\n    ion = import '../'\r\n    DynamicExpression = import './DynamicExpression'\r\n\r\nexport class ObjectExpression extends DynamicExpression\r\n    properties:\r\n        # this is called by a PropertyExpression to let us know the current left hand value.\r\n        setLeftValue: (value) ->\r\n            @value = value\r\n        activate: ->\r\n            super\r\n            @typeExpression ?= @context.createRuntime(@objectType ? null)\r\n            (@typeExpression.watch)\r\n                @typeWatcher ?= (type) =>\r\n                    let value\r\n                    if not ion.is(@value, type)\r\n                        @statements?.deactivate()\r\n                        @statements = null\r\n                        value = type ? {}\r\n                    else\r\n                        # a default value could have been passed in\r\n                        value = @value\r\n\r\n                    if value? and not @statements?\r\n                        let newContext = @context.newContext(value)\r\n                        @statements = newContext.createRuntime({type:'BlockStatement', body:@properties})\r\n                        @statements.activate()\r\n\r\n                    @setValue(value)\r\n        deactivate: ->\r\n            super\r\n            @typeExpression.unwatch(@typeWatcher)\r\n"]}