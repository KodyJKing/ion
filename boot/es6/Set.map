{"version":3,"sources":["Set.ion"],"names":[{"type":"Identifier","name":"SetShim","loc":{"start":{"line":3,"column":6,"fixed":true},"end":{"line":3,"column":13,"fixed":true}}},"SetShim","items","Error","map","Map","methods","has","key","delete","add","set","values","keys","forEach","callback","thisArg","value","call","Object","defineProperty","global","Set","prototype","console","warn","test","a","b"],"mappings":"aAAA;yBAAA;OAAA,CAAO,OAAP;AAEMA,SAAAC,OAAAD,CAAQE,KAARF,EACN;AAAA,IAAI,IAAGE,K,QAAH,EACJ;AAAA,QAAQ,MAAM,IAAIC,KAAJ,C,2EAAA,CAAN,CAAR;AAAA,KADA;AAAA,IAEI,IAAIC,GAAA,GAAM,IAAIC,GAAJ,EAAV,CAFJ;AAAA,IAGI,IAAMC,OAAA,GAAS;AAAA,YACXC,GAAA,EAAKP,UAACQ,GAADR,E;uBAASI,GAAA,CAAIG,GAAJ,CAAQC,GAAR,C;aADH;AAAA,YAEXC,MAAA,EAAQT,UAACQ,GAADR,E;uBAASI,GAAA,CAAIK,MAAJ,CAAWD,GAAX,C;aAFN;AAAA,YAGXE,GAAA,EAAKV,UAACQ,GAADR,E;uBAASI,GAAA,CAAIO,GAAJ,CAAQH,GAAR,EAAa,IAAb,C;aAHH;AAAA,YAIXI,MAAA,EAAQZ,Y;uBAAGI,GAAA,CAAIS,IAAJ,E;aAJA;AAAA,YAKXC,OAAA,EAASd,UAACe,QAADf,EAAWgB,OAAXhB,EACjB;AAAA,gBAAYI,GAAA,CAAIU,OAAJ,C,SACI,UAACG,KAAD,EAAQT,GAAR,EAChB;AAAA,oBAAoBO,QAAA,CAASG,IAAT,CAAcF,OAAd,EAAuBR,GAAvB,EAA4B,IAA5B,EAApB;AAAA,iB,OAFY,EAAZ;AAAA,aANmB;AAAA,SAAf,CAHJ;AAAA,IAaI,SAAIA,GAAJ,IAAkBF,OAAlB,EACJ;AAAA,Q,IADaW,K,GAASX,O,CAAdE,G,EACR;AAAA,QAAQW,MAAA,CAAOC,cAAP,CAAsB,IAAtB,EAAyBZ,GAAzB,EAA8B,EAACS,KAAA,EAAAA,KAAD,EAA9B,EAAR;AAAA,KAdA;AAAA,CAHA;AAoBA,IAAG,C,CAAII,MAAA,CAAOC,G,SAAX,IAAmB,C,CAAIA,GAAA,CAAIC,SAAJ,CAAcT,O,SAAxC,EACA;AAAA,IAAIU,OAAA,CAAQC,IAAR,CAAa,cAAb,EAAJ;AAAA,IACIJ,MAAA,CAAOC,GAAP,GAAarB,OAAb,CADJ;AAAA,CArBA;AAwBO,IAAMyB,IAAA,G,QAAAA,I,GAAO1B,YACpB;AAAA,QAAI,IAAMsB,GAAA,GAAMD,MAAA,CAAOC,GAAnB,CAAJ;AAAA,QACI,IAAIK,CAAA,GAAI,EAAR,CADJ;AAAA,QAEI,IAAIC,CAAA,GAAI5B,Y;SAAR,CAFJ;AAAA,QAGI,IAAIW,GAAA,GAAM,IAAIW,GAAJ,EAAV,CAHJ;AAAA,QAIIX,GAAA,CAAID,GAAJ,CAAQiB,CAAR,EAJJ;AAAA,QAKIhB,GAAA,CAAID,GAAJ,CAAQkB,CAAR,EALJ;AAAA,Q,KAMWjB,GAAA,CAAIJ,GAAJ,CAAQoB,CAAR,C;8DANX;AAAA,Q,KAOWhB,GAAA,CAAIJ,GAAJ,CAAQqB,CAAR,C;8DAPX;AAAA,QAQIjB,GAAA,CAAIF,MAAJ,CAAWmB,CAAX,EARJ;AAAA,Q,KASW,CAAIjB,GAAA,CAAIJ,GAAJ,CAAQqB,CAAR,C;kEATf;AAAA,QAUIjB,GAAA,CAAID,GAAJ,CAAQkB,CAAR,EAVJ;AAAA,Q,KAWWjB,GAAA,CAAIJ,GAAJ,CAAQqB,CAAR,C;8DAXX;AAAA,KADO","sourcesContent":["import './Map'\r\n\r\nconst SetShim(items) ->\r\n    if items?\r\n        throw new Error(\"Don't add items in the constructor, IE implementation of Set breaks this\")\r\n    let map = new Map\r\n    const methods =\r\n        has: (key) -> map.has(key)\r\n        delete: (key) -> map.delete(key)\r\n        add: (key) -> map.set(key, true)\r\n        values: -> map.keys()\r\n        forEach: (callback, thisArg) ->\r\n            map.forEach(\r\n                (value, key) =>\r\n                    callback.call(thisArg, key, @)\r\n            )\r\n    for key, value of methods\r\n        Object.defineProperty(@, key, {value})\r\n\r\n# we will even replace Googles crap implementation of Map that doesn't yet have forEach or keys\r\nif not global.Set? or not Set.prototype.forEach?\r\n    console.warn('Shimming Set')\r\n    global.Set = SetShim\r\n\r\nexport const test = ->\r\n    const Set = global.Set\r\n    let a = {}\r\n    let b = ->\r\n    let set = new Set()\r\n    set.add(a)\r\n    set.add(b)\r\n    assert set.has(a)\r\n    assert set.has(b)\r\n    set.delete(b)\r\n    assert not set.has(b)\r\n    set.add(b)\r\n    assert set.has(b)\r\n"]}